this.ckan.module("custom-fields",(function(e){return{options:{fieldSelector:".control-custom"},initialize:function(){e.proxyAll(this,/_on/);var t=this.options.fieldSelector+":last input:first";this.el.on("change",t,this._onChange),this.el.on("change",":checkbox",this._onRemove)},newField:function(e){this.el.append(this.cloneField(e))},cloneField:function(t){return this.resetField(e(t).clone())},resetField:function(e){function t(e,t){return(t||"").replace(/\d+/,(function(e){return 1+parseInt(e,10)}))}return e.find(":input").val("").attr("id",t).attr("name",t),e.find("label").text(t).attr("for",t),e},disableField:function(e,t){e.toggleClass("disabled",!1!==t)},_onChange:function(t){if(""!==t.target.value){var n=e(t.target).parents(this.options.fieldSelector);this.newField(n)}},_onRemove:function(t){var n=e(t.target).parents(this.options.fieldSelector);this.disableField(n,t.target.checked)}}}));