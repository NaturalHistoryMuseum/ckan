this.ckan.module("data-viewer",(function(t){return{options:{timeout:200,minHeight:400,padding:30},initialize:function(){t.proxyAll(this,/_on/),this.el.on("load",this._onLoad),this._FirefoxFix(),this.sandbox.subscribe("data-viewer-error",this._onDataViewerError)},_onDataViewerError:function(t){var i=this.el.parent();$(".data-viewer-error .collapse",i).html(t),$(".data-viewer-error",i).removeClass("js-hide"),this.el.hide()},_onLoad:function(){var t=this,i=$("body").data("site-root");this.el.attr("src").substring(0,i.length)===i?(this._recalibrate(),setInterval((function(){t._recalibrate()}),this.options.timeout)):this.el.css("height",600)},_recalibrate:function(){var t=$.makeArray($(this.el.contents().find("body").children()).map((t,i)=>$(i).outerHeight(!0))).reduce((t,i)=>t+i);t=Math.max(t,this.options.minHeight),this.el.css("height",t+this.options.padding)},_FirefoxFix:function(){/#$/.test(this.el.src)?this.el.src=this.el.src.substr(0,this.src.length-1):this.el.src=this.el.src+"#"}}}));