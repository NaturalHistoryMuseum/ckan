this.ckan.module("follow",(function(i){return{options:{action:null,type:null,id:null,loading:!1},initialize:function(){i.proxyAll(this,/_on/),this.el.on("click",this._onClick)},_onClick:function(i){var l=this.options;if(l.action&&l.type&&l.id&&!l.loading){i.preventDefault();var o=this.sandbox.client,s=l.action+"_"+l.type;l.loading=!0,this.el.addClass("disabled"),o.call("POST",s,{id:l.id},this._onClickLoaded)}},_onClickLoaded:function(i){var l=this.options,o=this.sandbox,s=l.action;l.loading=!1,this.el.removeClass("disabled"),"follow"==l.action?(l.action="unfollow",this.el.html('<i class="fa fa-times-circle"></i> '+this._("Unfollow")).removeClass("btn-success").addClass("btn-danger")):(l.action="follow",this.el.html('<i class="fa fa-plus-circle"></i> '+this._("Follow")).removeClass("btn-danger").addClass("btn-success")),o.publish("follow-"+s+"-"+l.id)}}}));