!function(e){var t=!0;function n(s,a){return 3==s.nodeType?function(n,s){var a=r(n.data);t&&(a=a.replace(/^ /,""));t=!!a.match(/ $/);a=a.slice(0,s);return a=e("<div/>").text(a).html()}(s,a):function(t,r){var s,a=(t=e(t)).clone().empty();return t.contents().each((function(){var e=r-a.text().length;0!=e&&(s=n(this,e))&&a.append(s)})),a}(s,a)}function r(e){return e.replace(/\s+/g," ")}e.fn.truncate=function(t){var s=e.extend({},e.fn.truncate.defaults,t),a=this.map((function(){if(!(e.trim(r(e(this).text())).length<=s.max_length)){var t,a,i=n(this,s.max_length-s.more.length-s.link_prefix.length-s.link_suffix.length),l=e(this).hide();return i.insertAfter(l),function t(n){var r=e(n);var s=r.children(":last");if(!s)return n;var a=s.css("display");if(!a||"inline"==a)return r;return t(s)}(i).append(s.ellipses+s.link_prefix+'<a href="#more" class="'+s.css_more_class+'">'+s.more+"</a>"+s.link_suffix),(t=l,a=e(t).children(":last"),a&&a.is("p")?a:t).append(s.link_prefix+'<a href="#less" class="'+s.css_less_class+'">'+s.less+"</a>"+s.link_suffix),i.find("a:last").click((function(e){e.preventDefault(),i.hide(),l.show(),i.trigger({type:"expand.truncate",relatedTarget:l[0]})})),l.find("a:last").click((function(e){e.preventDefault(),i.show(),l.hide(),i.trigger({type:"collapse.truncate",relatedTarget:l[0]})})),i[0]}}));return this.pushStack(a)},e.fn.truncate.defaults={max_length:100,more:"more",less:"less",ellipses:"â€¦",css_more_class:"truncator-link truncator-more",css_less_class:"truncator-link truncator-less",link_prefix:" (",link_suffix:")"}}(jQuery);